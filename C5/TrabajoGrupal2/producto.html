<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" , initial-scale="1.0" />
    <title>Producto</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Amatic+SC&family=Chewy&family=Dancing+Script&family=Indie+Flower&family=Lobster&family=Pacifico&family=Rock+Salt&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <nav>
        <ul class="menu">
          <li><a href="Home.html">Inicio</a></li>
          <li><a href="about.html">Sobre Nosotros</a></li>
          <li><a href="Producto.html">Productos</a></li>
          <li><a href="Contacto.html">Contacto</a></li>

        </ul>
      </nav>
    </header>
    <main>
      <h1>Nuestros Productos</h1>
      <p class="tematico">
        Aqu√≠ encontrar√°s una selecci√≥n de nuestros productos m√°s queridos (y
        odiados). Desde tazas personalizadas hasta camisetas con insultos
        cari√±osos, tenemos algo para todos los gustos.
      </p>
      <h2>Tazas Personalizadas</h2>
      <br />
      <p class="sub">Distintos dise√±os y colores para regalar algo diferente</p>

      <section
        class="img-alineada"
        class="img-alineada img"
        class="img-alineada img:hover"
      >
        <img src="IMG/taza.png" alt="taza personalizada" />
        <img src="IMG/taza1.png" alt="taza personalizada" />
        <img src="IMG/taza4.png" alt="taza personalizada" />
        <img src="IMG/taza5.png" alt="taza personalizada" />
      </section>
      <section class="personalizador">
        <h2>Personaliza tu producto</h2>
        <p class="sub">¬°Crea tu propia taza con un mensaje √∫nico!</p>
        <div class="producto-preview">
          <img
            src="IMG/taza-editable.png"
            alt="Taza base"
            class="producto-img"
          />
          <div id="textoPersonalizado" class="texto-sobre-img">
            Tu texto aqui
          </div>
        </div>

        <label for="inputTexto">Texto personalizado:</label>
        <input type="text" id="inputTexto" placeholder="Escribe tu frase" />
        <label for="tamanioFuente">Tama√±o de fuente:</label>
        <input type="range" id="tamanioFuente" min="10" max="80" value="20" />
        <span id="previewTamanio">20px</span>

        <label for="inputColor"><br />Color del texto</label>
        <input type="color" id="inputColor" value="#0d86f0" />
       
        <label for="fuente">Fuente creativa:</label>
        <select id="fuente">
          <option value="'Lobster', cursive">Lobster</option>
          <option value="'Pacifico', cursive">Pacifico</option>
          <option value="'Dancing Script', cursive">Dancing Script</option>
          <option value="'Amatic SC', cursive">Amatic SC</option>
          <option value="'Indie Flower', cursive">Indie Flower</option>
          <option value="'Chewy', cursive">Chewy</option>
          <option value="'Rock Salt', cursive">Rock Salt</option>
        </select>

        <label for="estilo"><br />Estilo del texto:</label>
        <select id="estilo">
          <option value="normal">Normal</option>
          <option value="italic">Cursiva</option>
          <option value="bold">Negrita</option>
          <option value="bold italic">Negrita + Cursiva</option>
        </select>

        <div class="galeria-stickers">
          <button onclick="agregarSticker('IMG/blabla.png')">üó£Ô∏è</button>
          <button onclick="agregarSticker('IMG/auch.png')">üí•</button>
          <button onclick="agregarSticker('IMG/.l..png')">üñï</button>
          <button onclick="agregarSticker('IMG/boca.png')">üíã</button>
          <button onclick="agregarSticker('IMG/ojo.png')">üëÄ</button>
        </div>

        <div class="btn">
        <button onclick="aplicarPersonalizacion()">Aplicar</button>
        <button onclick="agregarTazaAlCarrito()">A√±adir al carrito</button>
        </div>
      </section>
      <section>
        <h2>Camisas Personalizadas</h2>
        <p class="sub">Tenemos distintos colores y tallas disponibles</p>
        <div
          class="img-alineada"
          class="img-alineada img"
          class="img-alineada img:hover"
        >
          <img src="IMG/camisa1.png" alt="camisa personalizada" />
          <img src="IMG/camisa2.png" alt="camisa personalizada" />
          <img src="IMG/camisa3.png" alt="camisa personalizada" />
        </div>
        <h2>Personaliza tu producto</h2>
        <p class="sub">¬°Crea tu propia camisa con un mensaje √∫nico!</p>
        <div class="preview-producto">
          <img
            src="IMG/camisa-editable.png"
            alt="Camisa base"
            class="producto-imagen"
          />
          <div id="textoDise√±ado" class="texto-sobre-img">Tu texto aqu√≠</div>
        </div>
        <!-- <div class="contenedor-controles"> -->
        <label for="inputTextoCustom">Texto personalizado:</label>
        <input
          type="text"
          id="inputTextoCustom"
          placeholder="Escribe tu frase"
        />

        <label for="tamanioFuenteCustom">Tama√±o de fuente:</label>
        <div class="range">
        <input
          type="range"
          id="tamanioFuenteCustom"
          min="10"
          max="80"
          value="20"
        />
        <span id="previewTamanioCustom">20px</span>
          </div>
        <label for="inputColorCustom"><br />Color del texto</label>
        <input type="color" id="inputColorCustom" value="#0d86f0" />

        <label for="fuenteCustom">Fuente creativa:</label>
        <select id="fuenteCustom">
          <option value="'Lobster', cursive">Lobster</option>
          <option value="'Pacifico', cursive">Pacifico</option>
          <option value="'Dancing Script', cursive">Dancing Script</option>
          <option value="'Amatic SC', cursive">Amatic SC</option>
          <option value="'Indie Flower', cursive">Indie Flower</option>
          <option value="'Chewy', cursive">Chewy</option>
          <option value="'Rock Salt', cursive">Rock Salt</option>
        </select>

        <label for="estiloCustom"><br />Estilo del texto:</label>
        <select id="estiloCustom">
          <option value="normal">Normal</option>
          <option value="italic">Cursiva</option>
          <option value="bold">Negrita</option>
          <option value="bold italic">Negrita + Cursiva</option>
        </select>

         <div class="galeria-stickers">
          <button onclick="insertarStickerCustom('IMG/blabla.png')">üó£Ô∏è</button>
          <button onclick="insertarStickerCustom('IMG/auch.png')">üí•</button>
          <button onclick="insertarStickerCustom('IMG/.l..png')">üñï</button>
          <button onclick="insertarStickerCustom('IMG/boca.png')">üíã</button>
          <button onclick="insertarStickerCustom('IMG/ojo.png')">üëÄ</button>
        </div>

      <div class="btn">
        <button onclick="inicializarPersonalizacion()">Aplicar</button>
        <button onclick="agregarAlCarrito()">A√±adir al carrito</button>
      </div>
      <!-- </div> -->
      </section>
      <section>
        <h2>Jerseys Personalizados</h2>
        <br>
        <div
          class="img-alineada"
          class="img-alineada img"
          class="img-alineada img:hover"
          >
          <img src="IMG/jersey1.png" alt="Jersey personalizado">
          <img src="IMG/jersey2.png" alt="Jersey personalizado">
          <img src="IMG/jersey3.png" alt="Jersey personalizado">
          <br>
        </div>
      </section>
      <section class="vista-carrito">
        <h2>üõí Vista previa del carrito</h2>
        <ul id="lista-carrito-preview"></ul>
        <p id="total-preview">Total: 0 ‚Ç¨</p>
      
        <div class="botones-carrito">
          <a href="carrito.php"><button>Ver carrito completo</button></a>
          <button onclick="borrarCarrito()">Borrar carrito</button>
        </div>
      </section>
      <br><br>
    </main>
    <script>
      function fetchCarrito() {
        fetch("obtener_carrito.php")
          .then(res => res.json())
          .then(productos => {
            const lista = document.getElementById("lista-carrito-preview");
            const totalElem = document.getElementById("total-preview");
            lista.innerHTML = "";
            let total = 0;
    
            productos.forEach(p => {
              const li = document.createElement("li");
              li.textContent = `${p.nombre} - ${parseFloat(p.precio).toFixed(2)} ‚Ç¨`;
              lista.appendChild(li);
              total += parseFloat(p.precio);
            });
    
            totalElem.textContent = `Total: ${total.toFixed(2)} ‚Ç¨`;
          })
          .catch(error => console.error("Error al obtener el carrito:", error));
      }
    
      document.addEventListener("DOMContentLoaded", fetchCarrito);
    </script>
  </body>
  <footer>
    <p>&copy; 2025 Derechos reservados</p>
  </footer>
  <script src="../JS/submenu.js"></script>
  <script src="/aplicarPersonalizacion.js"></script>
  <script>
function fetchCarrito() {
    fetch("obtener_carrito.php")
      .then(res => res.json())
      .then(productos => {
        const lista = document.getElementById("lista-carrito-preview");
        const totalElem = document.getElementById("total-preview");
        lista.innerHTML = "";
        let total = 0;
  
        productos.forEach(p => {
          const li = document.createElement("li");
          li.textContent = `${p.nombre} - ${parseFloat(p.precio).toFixed(2)} ‚Ç¨`;
          lista.appendChild(li);
          total += parseFloat(p.precio);
        });
  
        totalElem.textContent = `Total: ${total.toFixed(2)} ‚Ç¨`;
      })
      .catch(error => console.error("Error al obtener el carrito:", error));
  }
  </script>
  
  
  <script>
    function mostrarSubmenuCustom(el) {
      const submenu = el.querySelector(".submenu-custom");
      if (submenu) submenu.style.display = "block";
    }

    function ocultarSubmenuCustom(el) {
      const submenu = el.querySelector(".submenu-custom");
      if (submenu) submenu.style.display = "none";
    }

    function inicializarPersonalizacion() {
      const inputTexto = document.getElementById("inputTextoCustom").value;
      const color = document.getElementById("inputColorCustom").value;
      const fuente = document.getElementById("fuenteCustom").value;
      const estilo = document.getElementById("estiloCustom").value;
      const tamanio = document.getElementById("tamanioFuenteCustom").value;

      const textoTarget = document.getElementById("textoDise√±ado");
      textoTarget.innerText = inputTexto || "Tu texto aqu√≠";
      textoTarget.style.color = color;
      textoTarget.style.fontFamily = fuente;
      textoTarget.style.fontSize = `${tamanio}px`;

      document.getElementById(
        "previewTamanioCustom"
      ).innerText = `${tamanio}px`;

      textoTarget.style.fontStyle = estilo.includes("italic")
        ? "italic"
        : "normal";
      textoTarget.style.fontWeight = estilo.includes("bold")
        ? "bold"
        : "normal";
    }

    function aplicarPersonalizacion() {
  const texto = document.getElementById("inputTexto").value || "Tu texto aqu√≠";
  const color = document.getElementById("inputColor").value;
  const fuente = document.getElementById("fuente").value;
  const estilo = document.getElementById("estilo").value;
  const tamanio = document.getElementById("tamanioFuente").value;

  const objetivo = document.getElementById("textoPersonalizado");
  objetivo.innerText = texto;
  objetivo.style.color = color;
  objetivo.style.fontFamily = fuente;
  objetivo.style.fontSize = `${tamanio}px`;
  document.getElementById("previewTamanio").textContent = `${tamanio}px`;

  objetivo.style.fontStyle = estilo.includes("italic") ? "italic" : "normal";
  objetivo.style.fontWeight = estilo.includes("bold") ? "bold" : "normal";
}


    let contadorBloques = 1;

    function insertarTextoEditable() {
      const zona = document.querySelector(".preview-producto");

      const nuevo = document.createElement("div");
      nuevo.className = "texto-editable";
      nuevo.innerText = `Texto ${contadorBloques++}`;
      nuevo.contentEditable = true;
      nuevo.style.position = "absolute";
      nuevo.style.left = "50%";
      nuevo.style.top = "50%";
      nuevo.style.cursor = "grab";

      zona.appendChild(nuevo);
      hacerElementoArrastrable(nuevo);
    }

    function guardarEnCarrito() {
      const texto =
        document.getElementById("inputTextoCustom").value || "Tu texto aqu√≠";
      const color = document.getElementById("inputColorCustom").value;
      const fuente = document.getElementById("fuenteCustom").value;
      const estilo = document.getElementById("estiloCustom").value;

      const item = {
        producto: "Taza personalizada",
        texto,
        color,
        fuente,
        estilo,
      };

      localStorage.setItem("carritoPersonalizado", JSON.stringify(item));
      alert("¬°Producto a√±adido al carrito!");
    }

    ["textoDise√±ado", "textoPersonalizado"].forEach((id) => {
  const texto = document.getElementById(id);
  if (!texto) return;

  let arrastrando = false;
  let offsetX = 0;
  let offsetY = 0;

  texto.style.position = "absolute";

  texto.addEventListener("mousedown", (e) => {
    arrastrando = true;
    const rect = texto.getBoundingClientRect();
    offsetX = e.clientX - rect.left;
    offsetY = e.clientY - rect.top;
    texto.style.cursor = "grabbing";
  });

  document.addEventListener("mousemove", (e) => {
    if (arrastrando) {
      const cont = texto.closest(".producto-preview, .preview-producto");
      if (!cont) return;
      const contRect = cont.getBoundingClientRect();
      texto.style.left = `${e.clientX - contRect.left - offsetX}px`;
      texto.style.top = `${e.clientY - contRect.top - offsetY}px`;
    }
  });

  document.addEventListener("mouseup", () => {
    arrastrando = false;
    texto.style.cursor = "grab";
  });
});


    function hacerElementoArrastrable(el) {
      let activo = false,
        offsetX = 0,
        offsetY = 0;

      el.addEventListener("mousedown", (e) => {
        activo = true;
        const rect = el.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
        el.style.cursor = "grabbing";
      });

      document.addEventListener("mousemove", (e) => {
        if (activo) {
          const area = document.querySelector(".preview-producto");
          const rect = area.getBoundingClientRect();
          el.style.left = `${e.clientX - rect.left - offsetX}px`;
          el.style.top = `${e.clientY - rect.top - offsetY}px`;
        }
      });

      document.addEventListener("mouseup", () => {
        activo = false;
        el.style.cursor = "grab";
      });
    }

    function insertarStickerCustom(url) {
      const zona = document.querySelector(".preview-producto");

      const contenedor = document.createElement("div");
      contenedor.className = "redimensionable";

      const imagen = document.createElement("img");
      imagen.src = url;
      imagen.draggable = false;

      contenedor.appendChild(imagen);
      zona.appendChild(contenedor);

      hacerElementoArrastrable(contenedor);

      contenedor.addEventListener("dblclick", () => contenedor.remove());
    }
  </script>
  <script>
    function agregarTazaAlCarrito() {
      const texto = document.getElementById("inputTexto").value || "Tu texto aqu√≠";
      const precio = 9.99; // Precio de la taza personalizada
      const nombre = "Taza personalizada: " + texto;
  
      const datos = {
        nombre: nombre,
        precio: precio
      };
  
      fetch("guardar_carrito.php", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
      })
      .then(response => response.text())
      .then(msg => {
        alert(msg);
        fetchCarrito();
      })
      .catch(err => {
        console.error("Error al guardar la taza:", err);
      });
    }
  </script>
  <script>
    function agregarAlCarrito() {
      const texto = document.getElementById("inputTextoCustom").value || "Tu texto aqu√≠";
      const precio = 14.99; // Define un precio por defecto o c√°mbialo din√°micamente si lo necesitas
      const nombre = "Camisa personalizada: " + texto;
  
      const datos = {
        nombre: nombre,
        precio: precio
      };
  
      fetch("guardar_carrito.php", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
      })
      .then(response => response.text())
      .then(msg => {
        alert(msg);
        fetchCarrito(); // Mensaje que viene desde PHP
      })
      .catch(err => {
        console.error(err);
        alert("Error al guardar en el carrito.");
      });
    }
  </script>
  
  <script>
    function borrarCarrito() {
  fetch("borrar_carrito.php", {
    method: "POST"
  })
    .then(res => res.text())
    .then(msg => {
      alert(msg);
      fetchCarrito(); // Actualiza la vista previa
    })
    .catch(err => {
      console.error("Error al borrar el carrito:", err);
    });
}
  </script>
  
</html> 